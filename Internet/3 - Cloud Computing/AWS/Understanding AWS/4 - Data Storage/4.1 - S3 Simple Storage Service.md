 
An **infinitely scaling storage service** to store and retrieve any amount of data, at any time, from anywhere on the web.

**Use cases:** Backup and storage, Disaster Recovery, Archive, Hybrid Cloud Storage, Application Hosting, Media Hosting, Data Lakes & big data analytics, Software delivery, Static website

When you use bucket default settings, you don't specify a Retain Until Date. Instead, you specify a **duration**, in either days or years, for which every object version placed in the bucket should be protected.

- **Buckets** (dictionaries) to store objects (files) **at regional level**.
- **Versioning** files at bucket level. Must enable versioning in source and destination buckets. Once you version-enable a bucket, it can never return to an unversioned state. Versioning can only be suspended once it has been enabled.
- **Replication** enables **automatic, asynchronous copying of objects across buckets.**
	- Cross-region replication
- **Services provided: Static website hosting**
	- S3 can host static websites and have them accessible on the Internet. If 403, makes sure the bucket policy allows public reads.
- **Lifecycle**: move between storage classes or using S3 Lifecycle configurations
	- ![[s3-storage-classes.png]]

- **Performance:**
	- **Store
		- **Baseline**
			- Amazon S3 automatically scales to high request rates, latency 100-200 ms
			- Your app can **achieve at least 3,500 PUT/COPY/POST/DELETE or 5,500 GET/HEAD requests per second per prefix in a bucket.**
			- There are no limits to the number of prefixes in a bucket. You can increase I/O performance by parallelizing reads. **For example, 10 prefixes in S3 bucket to parallelizing reads, can scale read performance to 55,000 read requests per second.**
		- **Multi-Part upload: big files divided into parts**, if uploading more than 5GB.
		- **Transfer acceleration** 
			- **transfer files to AWS Edge Location(part of CloudFront)** that are are optimized for fast content delivery by leveraging AWS's global network infrastructure, routing data through Edge Locations closest to the uploader.
			- then forward file to the S3 bucket in the target region within the AWS network backbone.
	- **Read
		- S3 Byte-Range Fetches
		- S3 Select & Glacier Select
	- **Batch Operations
- **Security**
	- Object Encryption
		- Server-Side Encryption
			- S3-Managed Keys - Enabled by default. AES-256
			- ![[SSE-S3.png]]
			- KMS keys stored in KMS (SSE-KMS): use KMS to manage encryption keys
			- ![[S3-KMS.png]]
				- KMS limits
					- Upload calls the GenerateDataKey KMS API
					- Download calls the Decrypt KMS API
					- Count towards the KMS quota per second (5500, 10000, 30000 req/s based on region)
					- You can request a quota increase using the Service Quotas Console
			- Customer-provided keys (SSE-C): manage your own encryption keys outside of AWS. HTTPS must be used.
			- ![[S3-SSE-Customer-provided-key.png]]
		- Client-Side Encryption
			- Use client libraries such as Amazon S3 Client-Side Encryption Library
			- Clients must encrypt data themselves before sending to Amazon S3  
			- Clients must decrypt data themselves when retrieving from Amazon S3
			- Customer fully manages the keys and encryption cycle
			- ![[S3-CSE.png]]
		- Encryption in transit(SSL/TLS)
			- S3 exposes two endpoints:
				- HTTP Endpoint – non encrypted  
				- HTTPS Endpoint – encryption in flight, recommended and mandatory for SSE-C 
			- Most clients would use the HTTPS endpoint by default
			- ![[S3-Force-encryption.png]]
		- Note
			- SSE-S3 encryption is automatically applied to new objects stored in S3 bucket
			- Optionally, you can “force encryption” using a bucket policy and refuse any API call to PUT an S3 object without encryption headers (SSE-KMS or SSE-C)
			- Bucket Policies are evaluated before “Default Encryption”
	- **pre-signed URL v.s. public URL**
		- pre-signed URL contains a signature that carries the user's credentials, inherited from the permissions of the user that generated the URL. They are temporary URLs that you can grant time-limited access to some actions.
	- **Policies: define the inbound and outbound traffic for a bucket
		- Explicit `DENY` in an IAM Policy will take precedence over an S3 bucket policy.
		- **User-based:** IAM Policies, API calls should be allowed for a specific user from IAM.
		- **Resource-based**: grant access to buckets/accounts, encrypt objects at upload
			- Bucket Policies
				- JSON based policies: Resource, Effect, Actions, Principal
				- Use cases
			- Object ACL(Access Control List): finer grain
			- Bucket ACL: less common
		- Note: an IAM principal can access an S3 object if 
			- The user IAM permissions ALLOW it OR the resource policy ALLOWS it
			- AND there’s no explicit DENY

	- Using S3 as a secure transfer point: a location or service within a system where data can be transferred securely between different entities. It often involves a service or mechanism that ensures the confidentiality, integrity, and availability of data during its transfer. This can include encryption of data in transit, authentication mechanisms to verify the identity of parties involved in the transfer, and protection against unauthorized access or interception. 
- **Encryption
	- **Default Encryption v.s. Bucket polices
		- Default Encryption is auto applied and bucket polices are added.
		- Bucket policies are evaluated before Default Encryption
	- **In objects
		- **Server-Side Encryption(SSE)
			- Using keys handled, managed and owned by AWS, using AES-256
			- Enabled by default for new buckets / objects
		- **SSE-KMS
			- key is from KMS
			- May be impacted by the KMS limits
			- The encryption keys are managed by AWS but you have full control over the rotation policy of the encryption key.
		- **SSE-C
			- keys managed by the customer outside of AWS
			- HTTPS is mandatory
		- **[DSSE-KMS(Dual-Layer SSE with Keys Stored in Key Management Service)](https://aws.amazon.com/blogs/aws/new-amazon-s3-dual-layer-server-side-encryption-with-keys-stored-in-aws-key-management-service-dsse-kms/)
		- **Client-Side Encryption(CSE)
	- **In transit/flight: SSL/TLS
		- HTTPS
		- Force encryption => use the bucket policy of aws:SecureTransport
- **CORS
	- Cross-Origin Resource Sharing: defines a way for client web applications that are loaded in one domain to interact with resources in a different domain
- **MFA Delete
	- Extra protection against permanent deletion, which forces users to use MFA codes before deleting S3 objects. It's an extra level of security to prevent accidental deletions.
	- `aws s3api put-bucket-versioning --bucket demo-stephane-mfa-delete-2020 --versioning-configuration Status=Enabled,MFADelete=Enabled --mfa "arn:aws:iam::XXXXXXXXXX:mfa/root-account-mfa-device XXXXXX --profile root-mfa-delete-demo(this is the profile)`
- **Glacier Valut Lock & S3 Object Lock
	Adopt a WORM model (Write Once Read Many)
	- **Glacier
		- Create a Vault Lock Policy
		- Lock the Policy for future edits
	- **Object
		- Block an object version deletion
		- Retention mode
			- Compliance
			- Governance: more lenient than compliance
		- Legal Hold: protect the object indefinitely, independent from retention period
- **Access Logs
	- Log all access to S3 buckets
	- Amazon Athena can then be used to run serverless analytics on top of the log files.
- **Access Points
	- To avoid unmanageable policies and manage security at scale.
	- Specific points to access corresponding resources.
- Event notifications: CRUD operations on the objects in S3
	- Events => S3 => SNS / SQS / Lambda
	- Events => EventBridge (Advanced filtering options with JSON rules) => over 18 services as destinations
	- IAM Permissions: Resource access policy
- S3 lambda
	- Use lambda to change the object before it is being retrieved.
	- E.g. redact PII data, convert data format, resize and watermark images, etc.
- **S3 File Gateway**: a type of AWS Storage Gateway that **extends on-premises file storage to the cloud**, i.e. access and store files in S3 using standard file protocols such as **NFS (Network File System) and SMB (Server Message Block**). With S3 File Gateway, the most recently accessed files can be cached locally for low-latency access, ensuring that users can quickly access frequently accessed files.
- **Payment**
	- In general, bucket owner pays for all the storage and data transfer costs associated with the bucket.
	- With requester pays bucket, the requester pays the cost of the request and the data downloaded from the bucket. Helpful when share large datasets with other accounts.